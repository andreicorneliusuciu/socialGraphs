{"batchcomplete":"","query":{"normalized":[{"from":"current_mirror","to":"Current mirror"}],"pages":{"554291":{"pageid":554291,"ns":0,"title":"Current mirror","revisions":[{"contentformat":"text/x-wiki","contentmodel":"wikitext","*":"{{Use dmy dates|date=July 2013}}\nA '''current mirror''' is a circuit designed to copy a [[electric current|current]] through one [[active device]] by controlling the current in another active device of a circuit, keeping the output current constant regardless of loading. The current being 'copied' can be, and sometimes is, a varying signal current. Conceptually, an ideal current mirror is simply an ideal ''inverting current amplifier'' that reverses the current direction as well or it is a [[amplifier#Input and output variables|current-controlled current source (CCCS)]]. The current mirror is used to provide bias currents and [[active load]]s to circuits. It can also be used to model a more realistic current source (since ideal current sources don't exist).\n\nThe circuit topology covered here is one that appears in many monolithic ICs. It is a [[Widlar current source|Widlar mirror]] without an emitter degeneration resistor in the follower (output) transistor. This topology can only be done in an IC as the matching has to be extremely close and cannot be achieved with discretes.\n\nAnother topology is the [[Wilson current mirror]]. The Wilson mirror solves the [[Early effect]] voltage problem in this design.\n\n==Mirror characteristics==\nThere are three main specifications that characterize a current mirror. The first is the transfer ratio (in the case of a current amplifier) or the output current magnitude (in the case of a constant current source CCS). The second is its AC output resistance, which determines how much the output current varies with the voltage applied to the mirror. The third specification is the minimum voltage drop across the output part of the mirror necessary to make it work properly. This minimum voltage is dictated by the need to keep the output transistor of the mirror in active mode. The range of voltages where the mirror works is called the '''compliance range''' and the voltage marking the boundary between good and bad behavior is called the '''compliance voltage'''. There are also a number of secondary performance issues with mirrors, for example, temperature stability.\n\n==Practical approximations==\nFor [[small-signal]] analysis the current mirror can be approximated by its equivalent [[Norton's theorem|Norton impedance]].\n\nIn [[large-signal]] hand analysis, a current mirror is usually and simply approximated by an ideal current source. However, an ideal current source is unrealistic in several respects:\n*it has infinite AC impedance, while a practical mirror has finite impedance\n*it provides the same current regardless of voltage, that is, there are no compliance range requirements\n*it has no frequency limitations, while a real mirror has limitations due to the parasitic capacitances of the transistors\n*the ideal source has no sensitivity to real-world effects like noise, power-supply voltage variations and component tolerances.\n\n==Circuit realizations of current mirrors==\n\n===Basic idea===\nA bipolar transistor can be used as the simplest ''current-to-current converter'' but its transfer ratio would highly depend on temperature variations, \u03b2 tolerances, etc. To eliminate these undesired disturbances, a current mirror is composed of two cascaded ''current-to-voltage'' and ''voltage-to-current'' converters placed at the same conditions and having reverse characteristics. It is not obligatory for them to be linear; the only requirement is their characteristics to be mirrorlike (for example, in the BJT current mirror below, they are logarithmic and exponential). Usually, two identical converters are used but the characteristic of the first one is reversed by applying a negative feedback. Thus a current mirror consists of two cascaded equal converters (the first - reversed and the second - direct).\n[[File:Simple bipolar mirror.svg|thumbnail|200px|Figure 1: A current mirror implemented with npn bipolar transistors using a resistor to set the reference current I<sub>REF</sub>; V<sub>CC</sub> = supply voltage]]\n\n===Basic BJT current mirror===\nIf a voltage is applied to the BJT base-emitter junction as an input quantity and the collector current is taken as an output quantity, the transistor will act as an ''exponential voltage-to-current converter''. By applying a negative feedback (simply joining the base and collector) the transistor can be \"reversed\" and it will begin acting as the opposite ''logarithmic current-to-voltage converter''; now it will adjust the \"output\" base-emitter voltage so as to pass the applied \"input\" collector current.\n\nThe simplest bipolar current mirror (shown in Figure 1) implements this idea. It consists of two cascaded transistor stages acting accordingly as a ''reversed'' and ''direct'' voltage-to-current converters. The emitter of transistor Q<sub>1</sub> is connected to ground. Its collector-base voltage is zero as shown. Consequently, the voltage drop across Q<sub>1</sub> is ''V''<sub>BE</sub>, that is, this voltage is set by the [[diode modelling#Shockley diode model|diode law]] and Q<sub>1</sub> is said to be [[diode-connected transistor|diode connected]]. (See also [[bipolar transistor#Ebers.E2.80.93Moll model|Ebers-Moll model]].) It is important to have Q<sub>1</sub> in the circuit instead of a simple diode, because Q<sub>1</sub> sets ''V<sub>BE</sub>'' for transistor Q<sub>2</sub>. If Q<sub>1</sub> and Q<sub>2</sub> are matched, that is, have substantially the same device properties, and if the mirror output voltage is chosen so the collector-base voltage of Q<sub>2</sub> is also zero, then the ''V<sub>BE</sub>''-value set by Q<sub>1</sub> results in an emitter current in the matched Q<sub>2</sub> that is the same as the emitter current in Q<sub>1</sub>{{citation needed|date=January 2016}}. Because Q<sub>1</sub> and Q<sub>2</sub> are matched, their \u03b2<sub>0</sub>-values also agree, making the mirror output current the same as the collector current of Q<sub>1</sub>.\n\nThe current delivered by the mirror for arbitrary collector-base reverse bias, ''V''<sub>CB</sub>, of [[bipolar junction transistor|the output transistor]] is given by:\n::<math> I_\\text{C} = I_\\text{S} \\left( e^{\\frac{V_\\text{BE}}{V_\\text{T}}} - 1 \\right) \\left(1 + \\frac{V_\\text{CE}}{V_\\text{A}}\\right),</math>\n\nwhere ''I<sub>S</sub>'' is the reverse saturation current or scale current; ''V<sub>T</sub>'', the [[Boltzmann constant#Role in semiconductor physics: the thermal voltage|thermal voltage]]; and ''V<sub>A</sub>'', the [[Early effect|Early voltage]]. This current is related to the reference current ''I''<sub>ref</sub> when the output transistor ''V<sub>CB</sub>'' = 0 V by:\n::<math> I_\\text{ref} = I_C \\left( 1 + \\frac{2}{\\beta_0} \\right),</math>\n\nas found using [[Kirchhoff's current law]] at the collector node of Q<sub>1</sub>:\n::<math> I_\\text{ref} = I_C + I_{B1} + I_{B2} \\ .</math>\n\nThe reference current supplies the collector current to Q<sub>1</sub> and the base currents to both transistors \u2014 when both transistors have zero base-collector bias, the two base currents are equal, I<sub>B1</sub> = I<sub>B2</sub> = I<sub>B</sub>.\n::<math> I_\\text{ref} = I_C + I_B + I_B = I_C + 2 I_B = I_C \\left(1 + \\frac {2} {\\beta_0} \\right),</math>\n\nParameter \u03b2<sub>0</sub> is the transistor \u03b2-value for ''V''<sub>CB</sub> = 0 V.\n\n====Output resistance====\nIf V<sub>BC</sub> is greater than zero in output transistor Q<sub>2</sub>, the collector current in Q<sub>2</sub> will be somewhat larger than for Q<sub>1</sub> due to the [[Early effect]]. In other words, the mirror has a finite output (or Norton) resistance given by the ''r<sub>o</sub>'' of the output transistor, namely:\n:<math> R_N = r_o = \\frac{V_A + V_{CE}}{I_C} \\ ,</math>\n\nwhere ''V<sub>A</sub>'' is the Early voltage; and ''V<sub>CE</sub>'', the collector-to-emitter voltage of output transistor.\n\n====Compliance voltage====\nTo keep the output transistor active, ''V<sub>CB</sub>'' \u2265 0 V. That means the lowest output voltage that results in correct mirror behavior, the compliance voltage, is ''V<sub>OUT</sub>'' = ''V<sub>CV</sub>'' = ''V<sub>BE</sub>'' under bias conditions with the output transistor at the output current level ''I<sub>C</sub>'' and with ''V<sub>CB</sub>'' = 0 V or, inverting the ''I-V'' relation above:\n::<math>V_{CV} = V_T \\ln\\left(\\frac{I_C}{I_S} + 1\\right),</math>\n\nwhere ''V<sub>T</sub>'' is the [[Boltzmann constant#Role in semiconductor physics: the thermal voltage|thermal voltage]]; and ''I<sub>S</sub>'', the reverse saturation current or scale current.\n\n====Extensions and complications====\nWhen Q<sub>2</sub> has ''V<sub>CB</sub>'' > 0 V, the transistors no longer are matched. In particular, their \u03b2-values differ due to the Early effect, with\n::<math>\\begin{align}\n \\beta_1 &= \\beta_0 \\\\\n \\beta_2 &= \\beta_0 \\left(1 + \\frac{V_{CB}}{V_A}\\right),\n\\end{align}</math>\n\nwhere V<sub>A</sub> is the [[Early effect|Early voltage]] and \u03b2<sub>0</sub> is the transistor \u03b2 for V<sub>CB</sub> = 0 V. Besides the difference due to the Early effect, the transistor \u03b2-values will differ because the \u03b2<sub>0</sub>-values depend on current, and the two transistors now carry different currents (see [[Gummel\u2013Poon model|Gummel-Poon model]]).\n\nFurther, Q<sub>2</sub> may get substantially hotter than Q<sub>1</sub> due to the associated higher power dissipation. To maintain matching, the temperature of the transistors must be nearly the same. In [[integrated circuit]]s and transistor arrays where both transistors are on the same die, this is easy to achieve. But if the two transistors are widely separated, the precision of the current mirror is compromised.\n\nAdditional matched transistors can be connected to the same base and will supply the same collector current. In other words, the right half of the circuit can be duplicated several times with various resistor values replacing R<sub>2</sub> on each. Note, however, that each additional right-half transistor \"steals\" a bit of collector current from Q<sub>1</sub> due to the non-zero base currents of the right-half transistors. This will result in a small reduction in the programmed current.\n\nSee also an [[two-port network#Example: bipolar current mirror with emitter degeneration|example of a mirror with emitter degeneration to increase mirror resistance]].\n\nFor the simple mirror shown in the diagram, typical values of <math>\\beta</math> will yield a current match of 1% or better.\n[[File:Simple MOSFET mirror.PNG|thumbnail|200px|Figure 2: An n-channel MOSFET current mirror with a resistor to set the reference current I<sub>REF</sub>; V<sub>DD</sub> is the supply voltage]]\n\n===Basic MOSFET current mirror===\nThe basic current mirror can also be implemented using MOSFET transistors, as shown in Figure 2. Transistor ''M''<sub>1</sub> is operating in the [[MOSFET#Modes of operation|saturation or active]] mode, and so is ''M''<sub>2</sub>. In this setup, the output current ''I''<sub>OUT</sub> is directly related to ''I''<sub>REF</sub>, as discussed next.\n\nThe drain current of a MOSFET ''I''<sub>D</sub> is a function of both the gate-source voltage and the drain-to-gate voltage of the MOSFET given by ''I''<sub>D</sub> = ''f'' (''V''<sub>GS</sub>, ''V''<sub>DG</sub>), a relationship derived from the functionality of the [[MOSFET]] device. In the case of transistor ''M''<sub>1</sub> of the mirror, ''I''<sub>D</sub> = ''I''<sub>REF</sub>. Reference current ''I''<sub>REF</sub> is a known current, and can be provided by a resistor as shown, or by a \"threshold-referenced\" or \"[[biasing|self-biased]]\" current source to ensure that it is constant, independent of voltage supply variations.<ref name=Gray-Meyer>{{Cite book  |author1=Paul R. Gray |author2=Paul J. Hurst |author3=Stephen H. Lewis |author4=Robert G. Meyer |title=Analysis and Design of Analog Integrated Circuits  |year= 2001  |page=308&ndash;309  |edition=Fourth  |publisher=Wiley  |location=New York  |isbn=0-471-32168-0}}</ref>\n\nUsing ''V''<sub>DG</sub> = 0 for transistor ''M''<sub>1</sub>, the drain current in ''M''<sub>1</sub> is ''I''<sub>D</sub> = ''f''(''V''<sub>GS</sub>, ''V''<sub>DG</sub>=0), so we find: ''f''(''V''<sub>GS</sub>, 0) = ''I''<sub>REF</sub>, implicitly determining the value of ''V''<sub>GS</sub>. Thus ''I''<sub>REF</sub> sets the value of ''V''<sub>GS</sub>. The circuit in the diagram forces the same ''V''<sub>GS</sub> to apply to transistor ''M''<sub>2</sub>. If ''M''<sub>2</sub> is also biased with zero ''V''<sub>DG</sub> and provided transistors ''M''<sub>1</sub> and ''M''<sub>2</sub> have good matching of their properties, such as channel length, width, threshold voltage, etc., the relationship ''I''<sub>OUT</sub> = ''f''(''V''<sub>GS</sub>, ''V''<sub>DG</sub> = 0) applies, thus setting ''I''<sub>OUT</sub> = ''I''<sub>REF</sub>; that is, the output current is the same as the reference current when ''V''<sub>DG</sub> = 0 for the output transistor, and both transistors are matched.\n\nThe drain-to-source voltage can be expressed as ''V''<sub>DS</sub> = ''V''<sub>DG</sub> + ''V''<sub>GS</sub>. With this substitution, the Shichman-Hodges model provides an approximate form for function ''f''(''V''<sub>GS</sub>, ''V''<sub>DG</sub>):<ref name=Gray-Meyer2>{{Cite book  |author=Gray  |title=Eq. 1.165, p. 44  |isbn=0-471-32168-0  |display-authors=etal}}</ref>\n::<math>\\begin{align}\n I_d &= f(V_{GS}, V_{DG}) \\\\\n &= \\frac{1}{2} K_p \\left(\\frac{W}{L}\\right)\\left(V_{GS} - V_{th}\\right)^2 \\left(1 + \\lambda V_{DS}\\right) \\\\\n &= \\frac{1}{2} K_p \\left[\\frac{W}{L}\\right]\\left[V_{GS} - V_{th}\\right]^2 \\left[1 + \\lambda (V_{DG} + V_{GS})\\right] , \\\\\n\\end{align}</math>\n\nwhere <math>K_p</math> is a technology-related constant associated with the transistor, ''W/L'' is the width to length ratio of the transistor, <math>V_{GS}</math> is the gate-source voltage, <math>V_{th}</math> is the threshold voltage, \u03bb is the [[channel length modulation]] constant, and <math>V_{DS}</math> is the drain-source voltage.\n\n====Output resistance====\nBecause of channel-length modulation, the mirror has a finite output (or Norton) resistance given by the ''r<sub>o</sub>'' of the output transistor, namely (see [[channel length modulation]]):\n::<math> R_N = r_o = \\frac{1}{I_D}\\left(\\frac{1}{\\lambda}r + V_{DS}\\right) = \\frac{1}{I_D}\\left(V_E L + V_{DS}\\right),</math>\n\nwhere ''\u03bb'' = channel-length modulation parameter and ''V<sub>DS</sub>'' = drain-to-source bias.\n\n====Compliance voltage====\nTo keep the output transistor resistance high, ''V<sub>DG</sub>'' \u2265 0 V.<ref group=\"nb\">Keeping the output resistance high means more than keeping the MOSFET in active mode, because the output resistance of real MOSFETs only begins to increase on entry into the active region, then rising to become close to maximum value only when ''V<sub>DG</sub>'' \u2265 0 V.</ref> (see Baker).<ref name=Baker>\n{{Cite book\n |author=R. Jacob Baker\n |title=CMOS Circuit Design, Layout and Simulation\n |edition=Third\n |year= 2010\n |pages=297, \u00a79.2.1 and Figure 20.28, p. 636\n |publisher=Wiley-IEEE\n |location=New York\n |isbn=978-0-470-88132-3\n}}</ref> That means the lowest output voltage that results in correct mirror behavior, the compliance voltage, is ''V<sub>OUT</sub>'' = ''V<sub>CV</sub>'' = ''V<sub>GS</sub>'' for the output transistor at the output current level with ''V<sub>DG</sub>'' = 0 V, or using the inverse of the ''f''-function, ''f<sup>&thinsp;\u22121</sup>'':\n::<math>V_{CV} = V_{GS} (\\text{for}\\ I_D\\ \\text{at} \\ V_{DG} = 0V) = f^{-1}(I_D) \\ \\text{with}\\ V_{DG} = 0 \\ .</math>\n\nFor Shichman-Hodges model, ''f<sup>\u22121</sup>'' is approximately a square-root function.\n\n====Extensions and reservations====\nA useful feature of this mirror is the linear dependence of ''f'' upon device width ''W'', a proportionality approximately satisfied even for models more accurate than the Shichman-Hodges model. Thus, by adjusting the ratio of widths of the two transistors, multiples of the reference current can be generated.\n\nThe Shichman-Hodges model<ref>[http://www.nanodottek.com/NDT14_08_2007.pdf NanoDotTek Report NDT14-08-2007, 12 August 2007]</ref> is accurate only for rather dated{{when|date=March 2013}} technology, although it often is used simply for convenience even today. Any quantitative design based upon new{{when|date=March 2013}} technology uses computer models for the devices that account for the changed current-voltage characteristics. Among the differences that must be accounted for in an accurate design is the failure of the square law in ''V''<sub>gs</sub> for voltage dependence and the very poor modeling of ''V''<sub>ds</sub> drain voltage dependence provided by \u03bb''V''<sub>ds</sub>. Another failure of the equations that proves very significant is the inaccurate dependence upon the channel length ''L''. A significant source of ''L''-dependence stems from \u03bb, as noted by Gray and Meyer, who also note that \u03bb usually must be taken from experimental data.<ref name=Gray-Meyer3>\n{{Cite book\n |author=Gray\n |title=p. 44\n |isbn=0-471-32168-0\n |display-authors=etal\n}}</ref>\n\nDue to the wide variation of V<sub>th</sub> even within a particular device number discrete versions are problematic. Although the variation can be somewhat compensated for by using a Source degenerate resistor its value becomes so large that the output resistance suffers (i.e. reduces). This variation relegates the MOSFET version to the IC/monolithic arena.\n\n===Feedback assisted current mirror===\n[[File:Gain-assisted current mirror.PNG|thumbnail|300px|Figure 3: Gain-boosted current mirror with op amp feedback to increase output resistance]]\n[[File:WIde-swing MOSFET mirror.PNG|thumbnail|300px|MOSFET version of gain-boosted current mirror; M<sub>1</sub> and M<sub>2</sub> are in active mode, while M<sub>3</sub> and M<sub>4</sub> are in Ohmic mode, and act like resistors. The operational amplifier provides feedback that maintains a high output resistance.]]\nFigure 3 shows a mirror using [[negative feedback]] to increase output resistance. Because of the op amp, these circuits are sometimes called '''gain-boosted current mirrors'''. Because they have relatively low compliance voltages, they also are called '''wide-swing current mirrors'''. A variety of circuits based upon this idea are in use,<ref name=Baker2>\n{{Cite book\n |author=R. Jacob Baker\n |title=\u00a7 20.2.4 pp. 645&ndash;646\n |isbn=978-0-470-88132-3\n}}</ref><ref name=Ivanov>\n{{Cite book\n |vauthors=Ivanov VI, Filanovksy IM|title=Operational amplifier speed and accuracy improvement: analog circuit design with structural methodology\n |edition=The Kluwer international series in engineering and computer science, v. 763\n |year= 2004\n |page=\u00a76.1, p. 105\u2013108\n |publisher=Kluwer Academic\n |location=Boston, Mass.\n |isbn=1-4020-7772-6\n |url=https://books.google.com/books?id=IuLsny9wKIIC&pg=PA110&dq=gain+boost+wide++%22current+mirror%22#PPA107,M1\n}}</ref><ref name=Sansen>\n{{Cite book\n |author=W. M. C. Sansen\n |title=Analog design essentials\n |year= 2006\n |page=\u00a70310, p. 93\n |publisher=Springer\n |location=New York ; Berlin\n |isbn=0-387-25746-2\n}}</ref> particularly for MOSFET mirrors because MOSFETs have rather low intrinsic output resistance values. A MOSFET version of Figure 3 is shown in Figure 4 where MOSFETs ''M<sub>3</sub>'' and ''M<sub>4</sub>'' operate in [[MOSFET#Modes of operation|Ohmic mode]] to play the same role as emitter resistors ''R<sub>E</sub>'' in Figure 3, and MOSFETs ''M<sub>1</sub>'' and ''M<sub>2</sub>'' operate in active mode in the same roles as mirror transistors ''Q<sub>1</sub>'' and ''Q<sub>2</sub>'' in Figure 3. An explanation follows of how the circuit in Figure 3 works.\n\nThe operational amplifier is fed the difference in voltages ''V<sub>1</sub> \u2212 V<sub>2</sub>'' at the top of the two emitter-leg resistors of value ''R<sub>E</sub>''. This difference is amplified by the op amp and fed to the base of output transistor ''Q<sub>2</sub>''. If the collector base reverse bias on ''Q<sub>2</sub>'' is increased by increasing the applied voltage ''V<sub>A</sub>'', the current in ''Q<sub>2</sub>'' increases, increasing ''V<sub>2</sub>'' and decreasing the difference ''V<sub>1</sub> \u2212 V<sub>2</sub>'' entering the op amp. Consequently, the base voltage of ''Q<sub>2</sub>'' is decreased, and ''V<sub>BE</sub>'' of ''Q<sub>2</sub>'' decreases, counteracting the increase in output current.\n\nIf the op amp gain ''A<sub>v</sub>'' is large, only a very small difference ''V<sub>1</sub> \u2212 V<sub>2</sub>'' is sufficient to generate the needed base voltage ''V<sub>B</sub>'' for ''Q<sub>2</sub>'', namely\n::<math> V_1 - V_2 = \\frac{V_B}{A_v} \\ .</math>\n\nConsequently, the currents in the two leg resistors are held nearly the same, and the output current of the mirror is very nearly the same as the collector current ''I<sub>C1</sub>'' in ''Q<sub>1</sub>'', which in turn is set by the reference current as\n::<math> I_\\text{ref} = I_{C1} \\left(1 + \\frac{1}{\\beta_1}\\right),</math>\n\nwhere \u03b2<sub>1</sub> for transistor ''Q<sub>1</sub>'' and \u03b2<sub>2</sub> for ''Q<sub>2</sub>'' differ due to the [[Early effect]] if the reverse bias across the collector-base of ''Q<sub>2</sub>'' is non-zero.\n\n====Output resistance====\n[[File:Mirror output resistance.PNG|thumb|300px|Figure 5: Small-signal circuit to determine output resistance of mirror; transistor Q<sub>2</sub> is replaced with its [[hybrid-pi model]]; a test current ''I''<sub>X</sub> at the output generates a voltage ''V''<sub>X</sub>, and the output resistance is ''R''<sub>out</sub> = ''V''<sub>X</sub> / ''I''<sub>X</sub>.]]\nAn idealized treatment of output resistance is given in the footnote.<ref group=\"nb\">An idealized version of the argument in the text, valid for infinite op amp gain, is as follows. If the op amp is replaced by a [[nullor]], voltage ''V''<sub>2</sub> = ''V''<sub>1</sub>, so the currents in the leg resistors are held at the same value. That means the emitter currents of the transistors are the same. If the ''V''<sub>CB</sub> of Q<sub>2</sub> increases, so does the output transistor \u03b2 because of the [[Early effect]]: \u03b2 = \u03b2<sub>0</sub>(1 + ''V''<sub>CB</sub> / ''V''<sub>A</sub>). Consequently the base current to Q<sub>2</sub> given by ''I''<sub>B</sub> = ''I''<sub>E</sub> / (\u03b2 + 1) decreases and the output current ''I''<sub>out</sub> = ''I''<sub>E</sub> / (1 + 1 / \u03b2) increases slightly because \u03b2 increases slightly. Doing the math,\n::<math>\\begin{align}\n \\frac{1}{R_\\text{out}} &= \\frac{\\partial I_\\text{out}}{\\partial V_{CB}}\n = I_E \\cdot \\frac{\\partial}{\\partial V_{CB}} \\left(\\frac{\\beta}{\\beta + 1}\\right)\n = I_E \\cdot \\frac{1}{(\\beta + 1)^2} \\cdot \\frac{\\partial\\beta}{\\partial V_{CB}} \\\\\n &= \\frac{\\beta I_E}{\\beta + 1} \\cdot \\frac{1}{\\beta} \\cdot \\frac{\\beta_0}{V_A} \\cdot \\frac{1}{\\beta + 1} \\\\\n &= I_\\text{out} \\cdot \\frac{1}{1 + \\frac{V_{CB}}{V_A}} \\cdot \\frac{1}{V_A} \\cdot \\frac{1}{\\beta + 1} \\\\\n &= \\frac{1}{(\\beta + 1) r_0} \\ ,\n\\end{align}</math>\n\nwhere the transistor output resistance is given by r<sub>O</sub> = (''V''<sub>A</sub> + ''V''<sub>CB</sub>) / ''I''<sub>out</sub>. That is, the ideal mirror resistance for the circuit using an ideal op amp [[nullor]] is ''R''<sub>out</sub> = (\u03b2 + 1c)r<sub>O</sub>, in agreement with the value given later in the text when the gain \u2192 \u221e.</ref> A small-signal analysis for an op amp with finite gain ''A''<sub>v</sub> but otherwise ideal is based upon Figure 5 (\u03b2, r<sub>O</sub> and ''r<sub>\u03c0</sub>'' refer to ''Q<sub>2</sub>''). To arrive at Figure 5, notice that the positive input of the op amp in Figure 3 is at AC ground, so the voltage input to the op amp is simply the AC emitter voltage ''V''<sub>e</sub> applied to its negative input, resulting in a voltage output of \u2212''A''<sub>v</sub> ''V''<sub>e</sub>. Using [[Ohm's law]] across the input resistance r<sub>\u03c0</sub> determines the small-signal base current ''I''<sub>b</sub> as:\n:<math> I_b = \\frac{V_e}\\frac{r_\\pi}{A_v + 1} \\ .</math>\n\nCombining this result with Ohm's law for <math>R_E</math>, <math>V_e</math> can be eliminated, to find:<ref group=\"nb\">As ''A''<sub>v</sub> \u2192 \u221e, ''V''<sub>e</sub> \u2192 0 and ''I''<sub>b</sub> \u2192 ''I<sub>X</sub>.</ref>\n:<math> I_b = I_X \\frac{R_E}{ R_E + \\frac{r_\\pi}{A_v + 1} } \\ .</math>\n\n[[Kirchhoff's voltage law]] from the test source ''I''<sub>X</sub> to the ground of ''R''<sub>E</sub> provides:\n:<math> V_X = (I_X + \\beta I_b) r_O + (I_X - I_b )R_E \\ .</math>\n\nSubstituting for ''I''<sub>b</sub> and collecting terms the output resistance ''R''<sub>out</sub> is found to be:\n:<math>R_\\text{out} = \\frac{V_X}{I_X} = r_O \\left( 1 + \\beta \\frac{R_E}{R_E + \\frac{r_\\pi}{A_v + 1}} \\right) + R_E\\|\\frac{r_\\pi}{A_v + 1} \\ .</math>\n\nFor a large gain ''A<sub>v</sub> \u226b r<sub>\u03c0</sub> / R<sub>E</sub>'' the maximum output resistance obtained with this circuit is\n:<math>R_\\text{out} = (\\beta + 1)r_O \\ ,</math>\n\na substantial improvement over the basic mirror where ''R''<sub>out</sub> = ''r<sub>O</sub>''.\n\nThe small-signal analysis of the MOSFET circuit of Figure 4 is obtained from the bipolar analysis by setting \u03b2 = ''g<sub>m</sub> r<sub>\u03c0</sub>'' in the formula for ''R''<sub>out</sub> and then letting ''r<sub>\u03c0</sub>'' \u2192 \u221e. The result is\n:<math>R_\\text{out} = r_O \\left[1 + g_m R_E(A_v + 1)\\right] + R_E \\ .</math>\n\nThis time, ''R<sub>E</sub>'' is the resistance of the source-leg MOSFETs M<sub>3</sub>, M<sub>4</sub>. Unlike Figure 3, however, as ''A<sub>v</sub>'' is increased (holding ''R<sub>E</sub>'' fixed in value), ''R''<sub>out</sub> continues to increase, and does not approach a limiting value at large ''A<sub>v</sub>''.\n\n====Compliance voltage====\nFor Figure 3, a large op amp gain achieves the maximum ''R''<sub>out</sub> with only a small ''R<sub>E</sub>''. A low value for ''R<sub>E</sub>'' means ''V<sub>2</sub>'' also is small, allowing a low compliance voltage for this mirror, only a voltage ''V<sub>2</sub>'' larger than the compliance voltage of the simple bipolar mirror. For this reason this type of mirror also is called a ''wide-swing current mirror'', because it allows the output voltage to swing low compared to other types of mirror that achieve a large ''R''<sub>out</sub> only at the expense of large compliance voltages.\n\nWith the MOSFET circuit of Figure 4, like the circuit in Figure 3, the larger the op amp gain ''A<sub>v</sub>'', the smaller ''R<sub>E</sub>'' can be made at a given ''R''<sub>out</sub>, and the lower the compliance voltage of the mirror.\n\n===Other current mirrors===\nThere are many sophisticated current mirrors that have higher [[output impedance|output resistances]] than the basic mirror (more closely approach an ideal mirror with current output independent of output voltage) and produce currents less sensitive to temperature and device parameter [[design for manufacturability (IC)|variations]] and to circuit voltage fluctuations. These multi-transistor mirror circuits are used both with bipolar and MOS transistors. These circuits include:\n*the [[Widlar current source]]\n*the [[Wilson current mirror]] used as a current source\n*[[Cascode]]d current sources\n\n==Notes==\n<references group=\"nb\"/>\n\n==See also==\n*[[Current source]]\n*[[Widlar current source]]\n*[[Wilson current mirror]]\n*[[Bipolar junction transistor]]\n*[[MOSFET]]\n*[[Channel length modulation]]\n*[[Early effect]]\n\n==References==\n<references/>\n\n==External links==\n{{Commons category|Current mirror circuits}}\n{{Wikibooks|Circuit Idea|How to Reverse Current Direction}}\n*[http://www.4qdtec.com/csm.html 4QD tec - Current sources and mirrors] Compendium of circuits and descriptions\n\n{{DEFAULTSORT:Current Mirror}}\n[[Category:Analog circuits]]\n[[Category:Electronic design]]"}]}}}}